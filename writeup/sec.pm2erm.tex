\section{Integration of Plate Models and Entity Relationship Models}

\subsection{Translation of Plate Models to Entity Relationship Models}

In this section we propose a technique to transform a given directed graphical model in plate notation into a well-formed database model. This is done in three steps:
\begin{enumerate}
\item Transform multidimensional variables such as vectors or matrices into multiple variables for their components. The resulting model is called an atomic plate model (APM).
\item\label{itm:apm2erm} Convert the APM into an ERM.
\item Reduce the ERM to avoid translation artifacts in edge cases.
\end{enumerate}
In step~\ref{itm:apm2erm}, the ERM is converted from the APM and not the original plate model to ensure that it is well-formed. Converting plate models containing multidimensional variables directly leads to database models containing non-atomic attributes or having implicit relationships by adding foreign key attributes [TODO: explain better, mb example or separate section?]. 

\subsubsection{Atomic Plate Models}

Multidimensional variables are split into their components such that there is one variable for each component. A plate containing an indexed component variable represents the multidimensional variable in the APM. Figure~\ref{fig:pm2apm} shows the conversion of plate models containing a vector and a matrix variable, respectively. The multidimensional variables $\vec x$ and $X$ are converted into individual component variables $x_n$ and $x_{nm}$, surrounded by plates of the corresponding dimensionality.

Multidimensional variables are often used as parameters for conditional probability distributions.\footnote{Consider the probabilities of a multinomial distribution $\vec \mu$ that contains the probability for each possible outcome or the covariance matrix $\Sigma$ of a multivariate gaussian distribution.} In that case one cannot decompose those variables without losing the relationship between their components concerning the generative process of the model. However, it is not necessary to preserve this relationship in the conversion process to a database model as it will not be used as a generative model anymore. We thus leave out all the arrows after the conversion process to explicitly state that they may not represent conditional probability distributions in the APM.

\begin{figure}
\centering
\scalebox{\tikzScale}{\adjustTikzSize \input{img/apm_vectors.tex}}
\caption{Conversion of plate models containing multidimensional variables to atomic plate models by modeling the components as indivual variables. Subfigure (a) shows the conversion of an $N$ dimensional vector variable $\vec x$ to its components $x_n$. In (b), the $N \times M$ matrix $X$ is converted into a variable inside of two plates, one for each dimension. Arrows are removed because they do not express conditional distributions anymore.}\label{fig:pm2apm}
\end{figure}

\begin{figure}[t]
\begin{minipage}[t]{0.49\linewidth}
	\begin{center}
		\subfloat[Original clustering plate model]{\label{fig:clustering_platemodel_original}
    	\scalebox{\tikzScale}{\adjustTikzSize \input{img/clustering_transformation_platemodel.tex}}}
	\end{center}
\end{minipage}
\hspace{0.0cm}
\begin{minipage}[t]{0.49\linewidth}
	\begin{center}
		\subfloat[Atomic clustering plate model]{\label{fig:clustering_platemodel_expanded}
		\scalebox{\tikzScale}{\adjustTikzSize \input{img/clustering_transformation_platemodel_expanded.tex}}}
	\end{center}
\end{minipage}\\
\caption{Transformation of the plate model for Dirichlet multinomial clustering of text documents from implicit vector variables to an atomic version.}
\label{img:clustering_platemodels}
\end{figure}

\subsubsection{Translation of Atomic Plate Models to Entitiy Relationship Models}

\textbf{APM $\Rightarrow$ ERM}
\begin{itemize}
\item variables $\Rightarrow$ attributes\footnote{Variables that are not inside of a plate need to be assigned to an artificial entity type called "Global" [CITATION NEEDED].}
\item plates $\Rightarrow$ entity types
\item plate intersections $\Rightarrow$ relationships (association entitites)
\item nested plates and constraints affect translation
\item covered / overlapping with the same index range / name are translated as many to many self relationships
\end{itemize}

\begin{figure}
\centering
\scalebox{\tikzScale}{\adjustTikzSize \input{img/pm2erm_uno_local.tex}}
\caption{Conversion of a plate containing a single variable to a single entity type having the corresponding attribute.}\label{fig:pm2erm_uno_local}
\end{figure}

\begin{figure}
\centering
\scalebox{\tikzScale}{\adjustTikzSize \input{img/pm2erm_uno_global.tex}}
\caption{Conversion of a single variable that is not located in any plate. It will be associated with an artificial entity type called Global.}\label{fig:pm2erm_uno_global}
\end{figure}

\begin{figure}
\centering
\scalebox{\tikzScale}{\adjustTikzSize \input{img/pm2erm_bi_noconstraints.tex}}
\caption{Conversion of a plate intersection to an association entity.}\label{fig:pm2erm_bi_noconstraints}
\end{figure}

\begin{figure}
\centering
\scalebox{\tikzScale}{\adjustTikzSize \input{img/pm2erm_covered_1.tex}}
\caption{Conversion of a covered plate to an association entity.}\label{fig:pm2erm_covered_1}
\end{figure}

\begin{figure}
\centering
\scalebox{\tikzScale}{\adjustTikzSize \input{img/pm2erm_bi_constraints.tex}}
\caption{Conversion of a plate intersection to an association entity given a variable constraint.}\label{fig:pm2erm_bi_constraints}
\end{figure}

\subsubsection{Reduction of Translated Entity Relationship Models}

\begin{itemize}
\item convert association entitites w/o attributes to relationships
\item convert degenerated 1:n relationships (expressed as 1:1 weak : 1:n)
\item merge 1:1 relationship entities
\item merge relationships
\end{itemize}

\subsection{Matching Domain Data Models and Translated Entity Relationship Models}

\begin{itemize}
\item domain data model given
\item set of machine learning algorithm data models available
\item match generic machine learning algorithm data model template
\item framework will select corresponding implementation and fill out the missing data (statistical inference)
\end{itemize}
